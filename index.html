<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Spelling Bee Contest – Licencias Educativas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root {
            --bg: #020617;
            --bg-soft: #02081b;
            --card: #020617;
            --card-soft: #020824;
            --accent: #f97316;
            --accent-soft: #fed7aa;
            --accent-strong: #ea580c;
            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
            --border-soft: #111827;
            --badge: #0f172a;
            --success: #22c55e;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
            color: var(--text-main);
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        /* HERO */
        header {
            background: radial-gradient(circle at top left, #f97316 0, #ef4444 30%, #020617 75%);
            padding: 2.25rem 1.5rem 4rem;
            color: #fff;
        }

        .hero-inner {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .hero-label {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            padding: .25rem .75rem;
            border-radius: 999px;
            background: rgba(15,23,42,.7);
            border: 1px solid rgba(249,115,22,.6);
            font-size: .75rem;
            text-transform: uppercase;
            letter-spacing: .08em;
        }

        .hero-title {
            font-size: clamp(1.9rem, 2.8vw, 2.6rem);
            font-weight: 700;
            margin: .75rem 0 .25rem;
        }

        .hero-subtitle {
            font-size: .95rem;
            max-width: 620px;
            line-height: 1.5;
        }

        .hero-cta {
            margin-top: 1.5rem;
            display: flex;
            flex-wrap: wrap;
            gap: .75rem;
        }

        .btn-pill-primary {
            border: none;
            border-radius: 999px;
            padding: .75rem 1.4rem;
            background: #020617;
            color: #fde68a;
            font-weight: 600;
            cursor: pointer;
            font-size: .9rem;
            box-shadow: 0 0 0 1px rgba(15,23,42,.8);
        }

        .btn-pill-secondary {
            border-radius: 999px;
            padding: .75rem 1.4rem;
            border: 1px solid rgba(15,23,42,.8);
            background: rgba(15,23,42,.6);
            color: #e5e7eb;
            font-size: .9rem;
            cursor: pointer;
        }

        .hero-columns {
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(0, 1.6fr);
            gap: 1.5rem;
            align-items: stretch;
        }

        .hero-card {
            border-radius: 18px;
            padding: 1.5rem 1.6rem;
            background: radial-gradient(circle at top left, #020617 0, #020617 60%, #02081b 100%);
            border: 1px solid rgba(15,23,42,.9);
            box-shadow: 0 18px 45px rgba(0,0,0,.65);
        }

            .hero-card h2 {
                margin: 0 0 .75rem;
                font-size: 1.05rem;
                letter-spacing: .02em;
                text-transform: uppercase;
                color: #9ca3af;
            }

            .hero-card h3 {
                margin: 0 0 .75rem;
                font-size: 1.25rem;
            }

        .hero-benefits {
            list-style: none;
            padding: 0;
            margin: 1rem 0 0;
            display: grid;
            gap: .6rem;
        }

            .hero-benefits li {
                display: flex;
                align-items: flex-start;
                gap: .5rem;
                font-size: .9rem;
                color: var(--text-muted);
            }

                .hero-benefits li span.icon {
                    width: 18px;
                    height: 18px;
                    border-radius: 999px;
                    background: rgba(34,197,94,.12);
                    border: 1px solid rgba(34,197,94,.5);
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    font-size: .7rem;
                    color: #bbf7d0;
                    margin-top: 2px;
                }

        /* MAIN LAYOUT */
        main {
            padding: 0 1.5rem 3.5rem;
        }

        .main-inner {
            max-width: 1100px;
            margin: 0 auto;
        }

        section {
            margin-top: 2.5rem;
        }

        /* PLANES */
        .section-title {
            font-size: 1.25rem;
            margin-bottom: .25rem;
        }

        .section-subtitle {
            font-size: .9rem;
            color: var(--text-muted);
            max-width: 620px;
        }

        .plans-grid {
            margin-top: 1.75rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1.25rem;
        }

        .plan-card {
            background: radial-gradient(circle at top left, #020617 0, #020617 50%, #02081b 100%);
            border-radius: 18px;
            padding: 1.35rem 1.4rem 1.4rem;
            border: 1px solid rgba(15,23,42,.9);
            box-shadow: 0 18px 40px rgba(0,0,0,.65);
            display: flex;
            flex-direction: column;
            min-height: 220px;
        }

        .plan-badge {
            align-self: flex-start;
            padding: .1rem .6rem;
            border-radius: 999px;
            background: rgba(15,23,42,.9);
            border: 1px solid rgba(148,163,184,.45);
            font-size: .7rem;
            text-transform: uppercase;
            letter-spacing: .08em;
            color: #e5e7eb;
            margin-bottom: .75rem;
        }

        .plan-title {
            font-size: 1.05rem;
            font-weight: 600;
            margin: 0 0 .35rem;
        }

        .plan-desc {
            font-size: .85rem;
            color: var(--text-muted);
            margin: 0 0 1rem;
        }

        .plan-price {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: .15rem;
        }

        .plan-meta {
            font-size: .8rem;
            color: #9ca3af;
            margin-bottom: 1rem;
        }

        .plan-footer {
            margin-top: auto;
            display: flex;
            justify-content: flex-start;
        }

        .plan-button {
            padding: .65rem 1.1rem;
            border-radius: 999px;
            border: none;
            background: var(--accent);
            color: #111827;
            font-weight: 600;
            font-size: .9rem;
            cursor: pointer;
        }

            .plan-button:hover {
                background: var(--accent-strong);
            }

        .plans-helper {
            font-size: .8rem;
            color: var(--text-muted);
            margin-top: .75rem;
        }

        /* CONTACTO */
        .contact-card {
            background: radial-gradient(circle at top left, #020617 0, #020617 60%, #02081b 100%);
            border-radius: 18px;
            border: 1px solid rgba(15,23,42,.9);
            padding: 1.4rem 1.6rem;
            box-shadow: 0 18px 40px rgba(0,0,0,.65);
            font-size: .9rem;
            color: var(--text-muted);
        }

            .contact-card strong {
                color: #e5e7eb;
            }

        footer {
            border-top: 1px solid rgba(15,23,42,.9);
            padding: 1.5rem;
            font-size: .8rem;
            color: #6b7280;
            background: #020617;
            text-align: center;
        }

        /* MODAL */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(15,23,42,.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .hidden {
            display: none !important;
        }

        .modal-content {
            width: 100%;
            max-width: 540px;
            background: linear-gradient(135deg, #020617 0, #02081b 60%, #020617 100%);
            border-radius: 20px;
            border: 1px solid rgba(15,23,42,1);
            box-shadow: 0 30px 80px rgba(0,0,0,.85);
            padding: 1.75rem 2rem 1.5rem;
            color: #e5e7eb;
        }

        .modal-header {
            margin-bottom: 1rem;
        }

            .modal-header h3 {
                margin: 0 0 .5rem;
                font-size: 1.1rem;
            }

            .modal-header p {
                margin: 0;
                font-size: .9rem;
                color: var(--text-muted);
            }

                .modal-header p strong {
                    color: #e5e7eb;
                }

        .modal-body {
            margin-top: 1rem;
        }

            .modal-body input {
                width: 100%;
                padding: .75rem .8rem;
                border-radius: 10px;
                border: 1px solid rgba(30,64,175,.8);
                background: rgba(15,23,42,.9);
                color: #e5e7eb;
                font-size: .9rem;
            }

        .modal-actions {
            display: flex;
            gap: .75rem;
            margin-top: 1.25rem;
        }

        .btn-modal-primary {
            flex: 1;
            border-radius: 999px;
            border: none;
            background: var(--accent);
            color: #111827;
            padding: .8rem 1rem;
            font-weight: 600;
            cursor: pointer;
            font-size: .9rem;
        }

            .btn-modal-primary:hover {
                background: var(--accent-strong);
            }

        .btn-modal-secondary {
            flex: 1;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,.6);
            background: transparent;
            color: #e5e7eb;
            padding: .8rem 1rem;
            font-size: .9rem;
            cursor: pointer;
        }

        .modal-hint {
            margin-top: .8rem;
            font-size: .75rem;
            color: #9ca3af;
        }

        @media (max-width: 840px) {
            .hero-columns {
                grid-template-columns: minmax(0, 1fr);
            }

            .modal-content {
                margin: 0 1rem;
                padding: 1.5rem 1.4rem 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- HERO -->
    <header>
        <div class="hero-inner">
            <div>
                <div class="hero-label">
                    <span>Spelling Bee Contest · Módulo para escuelas</span>
                </div>
                <h1 class="hero-title">Licencias profesionales para concursos de deletreo en inglés</h1>
                <p class="hero-subtitle">
                    Gestiona participantes, rondas, listas de palabras y puntuaciones en tiempo real.
                    Diseñado para docentes, coordinaciones académicas y eventos institucionales.
                </p>
                <div class="hero-cta">
                    <button class="btn-pill-primary">Piloto educativo · Aleteo Studios</button>
                    <button class="btn-pill-secondary">Solicitar demostración guiada</button>
                </div>
            </div>

            <div class="hero-columns">
                <article class="hero-card">
                    <h2>Panel para docentes</h2>
                    <h3>Convierte tu Spelling Bee en una experiencia profesional</h3>
                    <ul class="hero-benefits">
                        <li>
                            <span class="icon">✓</span>
                            <span>Rondas personalizadas, marcador en vivo y control de eliminación por error.</span>
                        </li>
                        <li>
                            <span class="icon">✓</span>
                            <span>Biblioteca de palabras configurable por nivel, temática o grado escolar.</span>
                        </li>
                        <li>
                            <span class="icon">✓</span>
                            <span>Diseñado para proyectarse en aula, auditorio o eventos intercolegiales.</span>
                        </li>
                    </ul>
                </article>

                <article class="hero-card">
                    <h2>Licencias educativas</h2>
                    <h3>Elige el plan que se adapta al contexto de tu institución</h3>
                    <ul class="hero-benefits">
                        <li>
                            <span class="icon">●</span>
                            <span>Modo docente y modo público para proyección en pantalla grande.</span>
                        </li>
                        <li>
                            <span class="icon">●</span>
                            <span>Paquetes mensuales, anuales o perpetuos para proyectos institucionales.</span>
                        </li>
                        <li>
                            <span class="icon">●</span>
                            <span>
                                Parte del portafolio educativo de <strong>Aleteo Studios</strong>, estudio de animación,
                                videojuegos y experiencias interactivas para educación.
                            </span>
                        </li>
                    </ul>
                </article>
            </div>
        </div>
    </header>

    <!-- CONTENIDO PRINCIPAL -->
    <main>
        <div class="main-inner">
            <!-- PLANES -->
            <section>
                <h2 class="section-title">Paquetes de licenciamiento</h2>
                <p class="section-subtitle">
                    Elige el plan que mejor se adapte a tu escuela. Los precios están pensados para instituciones que
                    desean probar el sistema en un evento piloto o integrarlo como parte de sus actividades anuales.
                </p>

                <div id="plans-container" class="plans-grid">
                    <!-- Aquí se cargarán los paquetes desde el backend -->
                </div>
                <p class="plans-helper">
                    Más adelante conectaremos estos botones con el sistema de pago y licencias definitivas.
                </p>
            </section>

            <!-- CONTACTO -->
            <section>
                <h2 class="section-title">Datos de contacto de la escuela</h2>
                <p class="section-subtitle">
                    Si te interesa recibir una demostración guiada o una cotización institucional,
                    comparte los datos de tu escuela. La información se utilizará solo para fines de contacto educativo
                    relacionados con Spelling Bee Contest.
                </p>

                <div class="contact-card">
                    <p>
                        <strong>¿Cómo funciona el proceso?</strong><br />
                        1) Seleccionas el paquete que se adapta a tu contexto.<br />
                        2) Realizamos una demostración guiada del sistema.<br />
                        3) Activamos la licencia para tu institución y te acompañamos en la primera edición del concurso.
                    </p>
                    <p style="margin-top: .75rem;">
                        Para más información, escribe a:
                        <strong>aletostudios@gmail.com</strong>
                    </p>
                </div>
            </section>
        </div>
    </main>

    <footer>
        Spelling Bee Contest · Piloto educativo desarrollado por Aleteo Studios · Uso académico y demostrativo.
    </footer>

    <!-- MODAL DE COMPRA -->
    <div id="purchase-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Comprar licencia</h3>
                <p>
                    Ingresa el correo de contacto de la escuela.<br />
                    <strong>Serás redirigido al sistema de pago.</strong>
                </p>
            </div>
            <div class="modal-body">
                <input type="email"
                       id="purchase-email"
                       placeholder="correo@escuela.com"
                       autocomplete="email" />
                <div class="modal-actions">
                    <button id="confirm-purchase" class="btn-modal-primary">
                        Continuar pago
                    </button>
                    <button id="close-modal" class="btn-modal-secondary">
                        Cancelar
                    </button>
                </div>
                <p class="modal-hint">
                    * Este correo se usará para generar y activar la licencia de Spelling Bee Contest.
                </p>
            </div>
        </div>
    </div>

    <!-- JS -->
    <script>
    const API_BASE = 'https://spelling-bee-contest-backend.vercel.app';
    let selectedPackageId = null;

    function getBadgeLabel(pkg) {
      if (pkg.id === 'PAQ1') return 'Mensual';
      if (pkg.id === 'PAQ2') return 'Anual';
      if (pkg.id === 'PAQ3') return 'Perpetua';
      return 'Licencia';
    }

    function getDurationLabel(pkg) {
      if (!pkg.duration_days) return 'Vigencia: Perpetua';
      if (pkg.duration_days === 30) return 'Vigencia: 30 días';
      if (pkg.duration_days >= 360) return 'Vigencia: 1 año';
      return 'Vigencia: ' + pkg.duration_days + ' días';
    }

    function formatPriceMXN(value) {
      return new Intl.NumberFormat('es-MX', {
        style: 'currency',
        currency: 'MXN',
        maximumFractionDigits: 0
      }).format(value || 0);
    }

    // Abre el modal de compra
    function openPurchaseModal(packageId, packageName) {
      selectedPackageId = packageId;
      const modal = document.getElementById('purchase-modal');
      const title = document.getElementById('modal-title');
      const emailInput = document.getElementById('purchase-email');

      if (!modal || !title || !emailInput) return;

      title.textContent = 'Comprar: ' + packageName;
      emailInput.value = '';
      modal.classList.remove('hidden');
      emailInput.focus();
    }

    // Carga los paquetes desde el backend
    async function loadPackages() {
      const container = document.getElementById('plans-container');
      if (!container) return;

      container.innerHTML = '<p style="color:#9ca3af;font-size:.85rem;">Cargando paquetes de licenciamiento…</p>';

      try {
        const res = await fetch(`${API_BASE}/api/packages`);
        const json = await res.json();

        if (!json.ok) {
          console.error('Error al cargar paquetes:', json.error);
          container.innerHTML =
            '<p style="color:#f87171;font-size:.85rem;">Ocurrió un error al cargar los paquetes. Intenta más tarde.</p>';
          return;
        }

        const packages = json.packages || [];
        container.innerHTML = '';

        packages.forEach((pkg) => {
          const card = document.createElement('article');
          card.className = 'plan-card';

          const badge = document.createElement('span');
          badge.className = 'plan-badge';
          badge.textContent = getBadgeLabel(pkg);

          const title = document.createElement('h3');
          title.className = 'plan-title';
          title.textContent = pkg.name;

          const desc = document.createElement('p');
          desc.className = 'plan-desc';
          desc.textContent =
            'Incluye acceso al módulo de docentes, control de rondas y listas de palabras configurables.';

          const price = document.createElement('p');
          price.className = 'plan-price';
          price.textContent = formatPriceMXN(pkg.price_mxn);

          const meta = document.createElement('p');
          meta.className = 'plan-meta';
          meta.textContent = getDurationLabel(pkg);

          const footer = document.createElement('div');
          footer.className = 'plan-footer';

          const btn = document.createElement('button');
          btn.className = 'plan-button';
          btn.textContent = 'Comprar';
          btn.dataset.packageId = pkg.id;

          btn.addEventListener('click', () => {
            openPurchaseModal(pkg.id, pkg.name);
          });

          footer.appendChild(btn);
          card.appendChild(badge);
          card.appendChild(title);
          card.appendChild(desc);
          card.appendChild(price);
          card.appendChild(meta);
          card.appendChild(footer);

          container.appendChild(card);
        });

        if (packages.length === 0) {
          container.innerHTML =
            '<p style="color:#9ca3af;font-size:.85rem;">Por el momento no hay paquetes configurados.</p>';
        }
      } catch (err) {
        console.error('Error inesperado cargando paquetes:', err);
        container.innerHTML =
          '<p style="color:#f87171;font-size:.85rem;">Ocurrió un error al cargar los paquetes. Intenta más tarde.</p>';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Eventos del modal
      const modal = document.getElementById('purchase-modal');
      const btnClose = document.getElementById('close-modal');
      const btnConfirm = document.getElementById('confirm-purchase');

      if (btnClose) {
        btnClose.addEventListener('click', () => {
          modal.classList.add('hidden');
        });
      }

      if (btnConfirm) {
        btnConfirm.addEventListener('click', async () => {
          const emailInput = document.getElementById('purchase-email');
          const email = emailInput.value.trim();

          if (!email) {
            alert('Por favor ingresa un correo válido.');
            emailInput.focus();
            return;
          }

          try {
            const res = await fetch(
              `${API_BASE}/api/checkout-test?package_id=${encodeURIComponent(
                selectedPackageId
              )}&email=${encodeURIComponent(email)}`
            );
            const data = await res.json();

            if (!data.ok) {
              alert('Ocurrió un error al iniciar el pago.');
              return;
            }

            // Aquí luego se reemplazará por la URL real de Mercado Pago
            window.location.href = data.fake_payment_url;
          } catch (err) {
            console.error(err);
            alert('Error inesperado al iniciar el pago.');
          }
        });
      }

      // Cargar planes
      loadPackages();
    });
    </script>
</body>
</html>
